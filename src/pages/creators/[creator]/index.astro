---
import Layout from '../../../layouts/Layout.astro';
import TripCard from '../../../components/TripCard.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const creators = await getCollection('creators');
  return creators.map(entry => ({
    params: { creator: entry.id }, props: { entry },
  }));
}
const { entry } = Astro.props;
const trips = (await getCollection('trips', ({ id }) => {
  return id.startsWith(entry.id);
})).sort(
    (a, b) => b.data.postdate.valueOf() - a.data.postdate.valueOf()
  );
---

<Layout title={entry.data.name}>
  <div class="creator-header">
    <img src={entry.data.photo.src} alt=`Profile image of ${entry.data.name}` height="88" width="88" />
    <div>
      <h1>{entry.data.name}</h1>
      <a href={entry.data.link}>{entry.data.link}</a>
    </div>
  </div>
  
  
  <div class="trips-listing">
    {trips.map(trip => (
      <TripCard
        trip_id={trip.id},
        title={trip.data.name},
        youtube_id={trip.data.source_id},
        date={trip.data.postdate}
      />
    ))}
  </div>
</Layout>

<style>
  .creator-header{
    display: flex;
    gap: 20px;
    margin-bottom: 40px;
    align-items: center;
    img {
      border-radius: 10px;
    }
    h1 {
      margin: 0 0 10px;
    }
    a {
      font-size: 1.2rem;
    }
  }
</style>